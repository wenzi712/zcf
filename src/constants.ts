import { homedir } from 'node:os';
import { join } from 'pathe';
import type { McpService } from './types';

export const CLAUDE_DIR = join(homedir(), '.claude');
export const SETTINGS_FILE = join(CLAUDE_DIR, 'settings.json');
export const CLAUDE_MD_FILE = join(CLAUDE_DIR, 'CLAUDE.md');
export const ClAUDE_CONFIG_FILE = join(homedir(), '.claude.json');
export const ZCF_CONFIG_FILE = join(homedir(), '.zcf.json');

export const SUPPORTED_LANGS = ['zh-CN', 'en'] as const;
export type SupportedLang = (typeof SUPPORTED_LANGS)[number];

export const LANG_LABELS = {
  'zh-CN': 'ç®€ä½“ä¸­æ–‡',
  en: 'English',
} as const;

export const AI_OUTPUT_LANGUAGES = {
  'zh-CN': { label: 'ç®€ä½“ä¸­æ–‡', directive: 'Always respond in Chinese-simplified' },
  en: { label: 'English', directive: 'Always respond in English' },
  custom: { label: 'Custom', directive: '' },
} as const;

export type AiOutputLanguage = keyof typeof AI_OUTPUT_LANGUAGES;

export const I18N = {
  'zh-CN': {
    selectScriptLang: 'é€‰æ‹©è„šæœ¬è¯­è¨€',
    selectConfigLang: 'é€‰æ‹© Claude Code é…ç½®è¯­è¨€',
    selectAiOutputLang: 'é€‰æ‹© AI è¾“å‡ºè¯­è¨€',
    aiOutputLangHint: 'AI å°†ä½¿ç”¨æ­¤è¯­è¨€å›å¤ä½ çš„é—®é¢˜',
    enterCustomLanguage: 'è¯·è¾“å…¥è‡ªå®šä¹‰è¯­è¨€ï¼ˆä¾‹å¦‚ï¼šJapanese, French ç­‰ï¼‰',
    configLangHint: {
      'zh-CN': 'ä¸­æ–‡ç‰ˆï¼ˆä¾¿äºä¸­æ–‡ç”¨æˆ·è‡ªå®šä¹‰ï¼‰',
      en: 'è‹±æ–‡ç‰ˆï¼ˆæ¨èï¼Œtoken æ¶ˆè€—æ›´ä½ï¼‰',
    },
    installPrompt: 'æ£€æµ‹åˆ° Claude Code æœªå®‰è£…ï¼Œæ˜¯å¦è‡ªåŠ¨å®‰è£…ï¼Ÿ',
    installing: 'æ­£åœ¨å®‰è£… Claude Code...',
    installSuccess: 'Claude Code å®‰è£…æˆåŠŸ',
    installFailed: 'Claude Code å®‰è£…å¤±è´¥',
    npmNotFound: 'npm æœªå®‰è£…ã€‚è¯·å…ˆå®‰è£… Node.js å’Œ npmã€‚',
    configureApi: 'é€‰æ‹© API è®¤è¯æ–¹å¼',
    useAuthToken: 'ä½¿ç”¨ Auth Token (OAuth è®¤è¯)',
    authTokenDesc: 'é€‚ç”¨äºé€šè¿‡ OAuth æˆ–æµè§ˆå™¨ç™»å½•è·å–çš„ä»¤ç‰Œ',
    useApiKey: 'ä½¿ç”¨ API Key (å¯†é’¥è®¤è¯)',
    apiKeyDesc: 'é€‚ç”¨äºä» Anthropic Console è·å–çš„ API å¯†é’¥',
    skipApi: 'è·³è¿‡ï¼ˆç¨åæ‰‹åŠ¨é…ç½®ï¼‰',
    enterApiUrl: 'è¯·è¾“å…¥ API URL',
    enterAuthToken: 'è¯·è¾“å…¥ Auth Token',
    enterApiKey: 'è¯·è¾“å…¥ API Key',
    // API modification related
    existingApiConfig: 'æ£€æµ‹åˆ°å·²æœ‰ API é…ç½®ï¼š',
    apiConfigUrl: 'URL',
    apiConfigKey: 'Key',
    apiConfigAuthType: 'è®¤è¯ç±»å‹',
    selectApiAction: 'è¯·é€‰æ‹©APIå¤„ç†æ“ä½œ',
    keepExistingConfig: 'ä¿ç•™ç°æœ‰é…ç½®',
    modifyAllConfig: 'ä¿®æ”¹å…¨éƒ¨é…ç½®',
    modifyPartialConfig: 'ä¿®æ”¹éƒ¨åˆ†é…ç½®',
    selectModifyItems: 'è¯·é€‰æ‹©è¦ä¿®æ”¹çš„é¡¹',
    modifyApiUrl: 'ä¿®æ”¹ API URL',
    modifyApiKey: 'ä¿®æ”¹ API Key',
    modifyAuthType: 'ä¿®æ”¹è®¤è¯ç±»å‹',
    continueModification: 'æ˜¯å¦ç»§ç»­ä¿®æ”¹å…¶ä»–é…ç½®ï¼Ÿ',
    modificationSaved: 'é…ç½®å·²ä¿å­˜',
    enterNewApiUrl: 'è¯·è¾“å…¥æ–°çš„ API URLï¼ˆå½“å‰ï¼š{url}ï¼‰',
    enterNewApiKey: 'è¯·è¾“å…¥æ–°çš„ API Keyï¼ˆå½“å‰ï¼š{key}ï¼‰',
    selectNewAuthType: 'é€‰æ‹©æ–°çš„è®¤è¯ç±»å‹ï¼ˆå½“å‰ï¼š{type}ï¼‰',
    existingConfig: 'æ£€æµ‹åˆ°å·²æœ‰é…ç½®æ–‡ä»¶ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ',
    backupAndOverwrite: 'å¤‡ä»½å¹¶è¦†ç›–å…¨éƒ¨',
    updateDocsOnly: 'ä»…æ›´æ–°å·¥ä½œæµç›¸å…³mdå¹¶å¤‡ä»½æ—§é…ç½®',
    mergeConfig: 'åˆå¹¶é…ç½®',
    skip: 'è·³è¿‡',
    backupSuccess: 'å·²å¤‡ä»½æ‰€æœ‰é…ç½®æ–‡ä»¶åˆ°',
    copying: 'æ­£åœ¨å¤åˆ¶é…ç½®æ–‡ä»¶...',
    configSuccess: 'é…ç½®æ–‡ä»¶å·²å¤åˆ¶åˆ°',
    apiConfigSuccess: 'API é…ç½®å®Œæˆ',
    mcpConfigSuccess: 'MCP æœåŠ¡å·²é…ç½®',
    selectMcpServices: 'é€‰æ‹©è¦å®‰è£…çš„ MCP æœåŠ¡ï¼ˆç©ºæ ¼é€‰æ‹©ï¼Œå›è½¦ç¡®è®¤ï¼‰',
    allServices: 'å…¨éƒ¨å®‰è£…',
    mcpServiceInstalled: 'å·²é€‰æ‹©çš„ MCP æœåŠ¡',
    enterExaApiKey: 'è¯·è¾“å…¥ Exa API Keyï¼ˆå¯ä» https://dashboard.exa.ai/api-keys è·å–ï¼‰',
    skipMcp: 'è·³è¿‡ MCP é…ç½®',
    configureMcp: 'æ˜¯å¦é…ç½® MCP æœåŠ¡ï¼Ÿ',
    mcpBackupSuccess: 'å·²å¤‡ä»½åŸæœ‰ MCP é…ç½®',
    complete: "ğŸ‰ é…ç½®å®Œæˆï¼ä½¿ç”¨ 'claude' å‘½ä»¤å¼€å§‹ä½“éªŒã€‚",
    error: 'é”™è¯¯',
    yes: 'æ˜¯',
    no: 'å¦',
    cancelled: 'æ“ä½œå·²å–æ¶ˆ',
    apiKeyValidation: {
      empty: 'API Key ä¸èƒ½ä¸ºç©º',
      example: 'ç¤ºä¾‹æ ¼å¼: sk-abcdef123456_789xyz',
    },
    noExistingConfig: 'æœªæ‰¾åˆ°ç°æœ‰é…ç½®ã€‚è¯·å…ˆè¿è¡Œ `zcf`ã€‚',
    updatingPrompts: 'æ­£åœ¨æ›´æ–° Claude Code Prompt æ–‡æ¡£...',
    updateConfigLangPrompt: 'é€‰æ‹©é…ç½®è¯­è¨€',
    updateConfigLangChoice: {
      'zh-CN': 'ä¸­æ–‡ç‰ˆé…ç½®',
      en: 'è‹±æ–‡ç‰ˆé…ç½®',
    },
    // Menu related
    selectFunction: 'è¯·é€‰æ‹©åŠŸèƒ½',
    enterChoice: 'è¯·è¾“å…¥é€‰é¡¹',
    menuOptions: {
      fullInit: 'å®Œæ•´åˆå§‹åŒ–',
      importWorkflow: 'å¯¼å…¥å·¥ä½œæµ',
      configureApi: 'é…ç½® API',
      configureMcp: 'é…ç½® MCP',
      configureModel: 'é…ç½®é»˜è®¤æ¨¡å‹',
      configureAiMemory: 'é…ç½® Claude å…¨å±€è®°å¿†',
      clearCache: 'æ¸…é™¤ ZCF åå¥½ç¼“å­˜',
      changeLanguage: 'æ›´æ”¹ç•Œé¢è¯­è¨€ / Change Interface Language',
      exit: 'é€€å‡º',
    },
    menuDescriptions: {
      fullInit: 'å®‰è£… Claude Code + å¯¼å…¥å·¥ä½œæµ + é…ç½® API + é…ç½® MCP æœåŠ¡',
      importWorkflow: 'ä»…å¯¼å…¥/æ›´æ–°å·¥ä½œæµç›¸å…³æ–‡ä»¶',
      configureApi: 'é…ç½® API URL å’Œè®¤è¯ä¿¡æ¯',
      configureMcp: 'é…ç½® MCP æœåŠ¡ï¼ˆå« Windows ä¿®å¤ï¼‰',
      configureModel: 'è®¾ç½®é»˜è®¤æ¨¡å‹ï¼ˆopus/sonnetï¼‰',
      configureAiMemory: 'é…ç½® AI è¾“å‡ºè¯­è¨€å’Œè§’è‰²é£æ ¼',
      clearCache: 'æ¸…é™¤åå¥½è¯­è¨€ç­‰ç¼“å­˜',
      changeLanguage: 'æ›´æ”¹ ZCF ç•Œé¢è¯­è¨€',
    },
    returnToMenu: 'è¿”å›ä¸»èœå•ï¼Ÿ',
    goodbye: 'å†è§ï¼ğŸ‘‹',
    // Model config
    selectDefaultModel: 'é€‰æ‹©é»˜è®¤æ¨¡å‹',
    modelConfigSuccess: 'é»˜è®¤æ¨¡å‹å·²é…ç½®',
    // AI memory config
    selectMemoryOption: 'é€‰æ‹©é…ç½®é€‰é¡¹',
    configureAiLanguage: 'é…ç½® AI è¾“å‡ºè¯­è¨€',
    configureAiPersonality: 'é…ç½® AI ä¸ªæ€§é£æ ¼',
    aiLanguageConfigured: 'AI è¾“å‡ºè¯­è¨€å·²é…ç½®',
    // AI personality
    selectAiPersonality: 'é€‰æ‹© AI ä¸ªæ€§é£æ ¼',
    customPersonalityHint: 'å®šä¹‰ä½ è‡ªå·±çš„ä¸ªæ€§',
    enterCustomPersonality: 'è¯·è¾“å…¥è‡ªå®šä¹‰ä¸ªæ€§æè¿°',
    personalityConfigured: 'AI ä¸ªæ€§å·²é…ç½®',
    // Cache
    confirmClearCache: 'ç¡®è®¤æ¸…é™¤æ‰€æœ‰ ZCF åå¥½ç¼“å­˜ï¼Ÿ',
    cacheCleared: 'ZCF ç¼“å­˜å·²æ¸…é™¤',
    noCacheFound: 'æœªæ‰¾åˆ°ç¼“å­˜æ–‡ä»¶',
    // Language
    languageChanged: 'è¯­è¨€å·²æ›´æ”¹',
    // Windows MCP
    fixWindowsMcp: 'ä¿®å¤ Windows MCP é…ç½®',
    fixWindowsMcpDesc: 'ä¿®å¤ Windows å¹³å° MCP å‘½ä»¤é…ç½®é—®é¢˜',
    windowsMcpFixed: 'Windows MCP é…ç½®å·²ä¿®å¤',
    configureMcpServices: 'é…ç½® MCP æœåŠ¡',
    selectMcpOption: 'é€‰æ‹© MCP é…ç½®é€‰é¡¹',
  },
  en: {
    selectScriptLang: 'Select script language',
    selectConfigLang: 'Select Claude Code configuration language',
    selectAiOutputLang: 'Select AI output language',
    aiOutputLangHint: 'AI will respond to you in this language',
    enterCustomLanguage: 'Enter custom language (e.g., Japanese, French, etc.)',
    configLangHint: {
      'zh-CN': 'Chinese (easier for Chinese users to customize)',
      en: 'English (recommended, lower token consumption)',
    },
    installPrompt: 'Claude Code not found. Install automatically?',
    installing: 'Installing Claude Code...',
    installSuccess: 'Claude Code installed successfully',
    installFailed: 'Failed to install Claude Code',
    npmNotFound: 'npm is not installed. Please install Node.js and npm first.',
    configureApi: 'Select API authentication method',
    useAuthToken: 'Use Auth Token (OAuth authentication)',
    authTokenDesc: 'For tokens obtained via OAuth or browser login',
    useApiKey: 'Use API Key (Key authentication)',
    apiKeyDesc: 'For API keys from Anthropic Console',
    skipApi: 'Skip (configure manually later)',
    enterApiUrl: 'Enter API URL',
    enterAuthToken: 'Enter Auth Token',
    enterApiKey: 'Enter API Key',
    // API modification related
    existingApiConfig: 'Existing API configuration detected:',
    apiConfigUrl: 'URL',
    apiConfigKey: 'Key',
    apiConfigAuthType: 'Auth Type',
    selectApiAction: 'Select API processing operation',
    keepExistingConfig: 'Keep existing configuration',
    modifyAllConfig: 'Modify all configuration',
    modifyPartialConfig: 'Modify partial configuration',
    selectModifyItems: 'Select items to modify',
    modifyApiUrl: 'Modify API URL',
    modifyApiKey: 'Modify API Key',
    modifyAuthType: 'Modify auth type',
    continueModification: 'Continue modifying other configurations?',
    modificationSaved: 'Configuration saved',
    enterNewApiUrl: 'Enter new API URL (current: {url})',
    enterNewApiKey: 'Enter new API Key (current: {key})',
    selectNewAuthType: 'Select new auth type (current: {type})',
    existingConfig: 'Existing config detected. How to proceed?',
    backupAndOverwrite: 'Backup and overwrite all',
    updateDocsOnly: 'Update workflow-related md files only with backup',
    mergeConfig: 'Merge config',
    skip: 'Skip',
    backupSuccess: 'All config files backed up to',
    copying: 'Copying configuration files...',
    configSuccess: 'Config files copied to',
    apiConfigSuccess: 'API configured',
    mcpConfigSuccess: 'MCP services configured',
    selectMcpServices: 'Select MCP services to install (space to select, enter to confirm)',
    allServices: 'Install all',
    mcpServiceInstalled: 'Selected MCP services',
    enterExaApiKey: 'Enter Exa API Key (get from https://dashboard.exa.ai/api-keys)',
    skipMcp: 'Skip MCP configuration',
    configureMcp: 'Configure MCP services?',
    mcpBackupSuccess: 'Original MCP config backed up',
    complete: "ğŸ‰ Setup complete! Use 'claude' command to start.",
    error: 'Error',
    yes: 'Yes',
    no: 'No',
    cancelled: 'Operation cancelled',
    apiKeyValidation: {
      empty: 'API Key cannot be empty',
      example: 'Example format: sk-abcdef123456_789xyz',
    },
    noExistingConfig: 'No existing configuration found. Please run `zcf` first.',
    updatingPrompts: 'Updating Claude Code prompt documents...',
    updateConfigLangPrompt: 'Select configuration language',
    updateConfigLangChoice: {
      'zh-CN': 'Chinese configuration',
      en: 'English configuration',
    },
    // Menu related
    selectFunction: 'Select function',
    enterChoice: 'Enter your choice',
    menuOptions: {
      fullInit: 'Full initialization',
      importWorkflow: 'Import workflow',
      configureApi: 'Configure API',
      configureMcp: 'Configure MCP',
      configureModel: 'Configure default model',
      configureAiMemory: 'Configure Claude global memory',
      clearCache: 'Clear ZCF preference cache',
      changeLanguage: 'Change interface language / æ›´æ”¹ç•Œé¢è¯­è¨€',
      exit: 'Exit',
    },
    menuDescriptions: {
      fullInit: 'Install Claude Code + Import workflow + Configure API + Configure MCP services',
      importWorkflow: 'Import/update workflow-related files only',
      configureApi: 'Configure API URL and authentication',
      configureMcp: 'Configure MCP services (includes Windows fix)',
      configureModel: 'Set default model (opus/sonnet)',
      configureAiMemory: 'Configure AI output language and personality',
      clearCache: 'Clear preference language and other caches',
      changeLanguage: 'Change ZCF interface language',
    },
    returnToMenu: 'Return to main menu?',
    goodbye: 'Goodbye! ğŸ‘‹',
    // Model config
    selectDefaultModel: 'Select default model',
    modelConfigSuccess: 'Default model configured',
    // AI memory config
    selectMemoryOption: 'Select configuration option',
    configureAiLanguage: 'Configure AI output language',
    configureAiPersonality: 'Configure AI personality',
    aiLanguageConfigured: 'AI output language configured',
    // AI personality
    selectAiPersonality: 'Select AI personality',
    customPersonalityHint: 'Define your own personality',
    enterCustomPersonality: 'Enter custom personality description',
    personalityConfigured: 'AI personality configured',
    // Cache
    confirmClearCache: 'Confirm clear all ZCF preference cache?',
    cacheCleared: 'ZCF cache cleared',
    noCacheFound: 'No cache file found',
    // Language
    languageChanged: 'Language changed',
    // Windows MCP
    fixWindowsMcp: 'Fix Windows MCP Configuration',
    fixWindowsMcpDesc: 'Fix Windows platform MCP command configuration issues',
    windowsMcpFixed: 'Windows MCP configuration fixed',
    configureMcpServices: 'Configure MCP Services',
    selectMcpOption: 'Select MCP configuration option',
  },
};

export const MCP_SERVICES: McpService[] = [
  {
    id: 'context7',
    name: { 'zh-CN': 'Context7 æ–‡æ¡£æŸ¥è¯¢', en: 'Context7 Docs' },
    description: {
      'zh-CN': 'æŸ¥è¯¢æœ€æ–°çš„åº“æ–‡æ¡£å’Œä»£ç ç¤ºä¾‹',
      en: 'Query latest library documentation and code examples',
    },
    requiresApiKey: false,
    config: {
      type: 'stdio',
      command: 'npx',
      args: ['-y', '@upstash/context7-mcp'],
      env: {},
    },
  },
  {
    id: 'mcp-deepwiki',
    name: { 'zh-CN': 'DeepWiki', en: 'DeepWiki' },
    description: {
      'zh-CN': 'æŸ¥è¯¢ GitHub ä»“åº“æ–‡æ¡£å’Œç¤ºä¾‹',
      en: 'Query GitHub repository documentation and examples',
    },
    requiresApiKey: false,
    config: {
      type: 'stdio',
      command: 'npx',
      args: ['-y', 'mcp-deepwiki@latest'],
      env: {},
    },
  },
  {
    id: 'Playwright',
    name: { 'zh-CN': 'Playwright æµè§ˆå™¨æ§åˆ¶', en: 'Playwright Browser Control' },
    description: {
      'zh-CN': 'ç›´æ¥æ§åˆ¶æµè§ˆå™¨è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œ',
      en: 'Direct browser control for automation',
    },
    requiresApiKey: false,
    config: {
      type: 'stdio',
      command: 'npx',
      args: ['-y', '@playwright/mcp@latest'],
      env: {},
    },
  },
  {
    id: 'exa',
    name: { 'zh-CN': 'Exa AI æœç´¢', en: 'Exa AI Search' },
    description: {
      'zh-CN': 'ä½¿ç”¨ Exa AI è¿›è¡Œç½‘é¡µæœç´¢',
      en: 'Web search using Exa AI',
    },
    requiresApiKey: true,
    apiKeyPrompt: {
      'zh-CN': 'è¯·è¾“å…¥ Exa API Key',
      en: 'Enter Exa API Key',
    },
    apiKeyPlaceholder: 'YOUR_EXA_API_KEY',
    config: {
      type: 'stdio',
      command: 'npx',
      args: ['-y', 'mcp-remote', 'https://mcp.exa.ai/mcp?exaApiKey=YOUR_EXA_API_KEY'],
      env: {},
    },
  },
];
