#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ“ Validating commit message format..."

# Run commitlint to validate the commit message
npx commitlint --edit $1

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Commit message does not follow Conventional Commits format!"
  echo ""
  echo "â„¹ï¸  Expected format: <type>(<scope>): <subject>"
  echo ""
  echo "ğŸ“‹ Examples of valid commit messages:"
  echo "   feat: add new feature"
  echo "   fix(api): resolve authentication issue"
  echo "   docs: update README with installation guide"
  echo "   test(cli): add unit tests for command parsing"
  echo "   chore: update dependencies"
  echo ""
  echo "ğŸ·ï¸  Valid types: feat, fix, docs, style, refactor, test, chore, build, ci, perf, revert"
  echo "ğŸ¯ Scope is optional: feat(scope): message OR feat: message"
  echo "ğŸ“ Keep header under 100 characters"
  echo "ğŸ”¤ Subject should be lowercase and not end with period"
  echo ""
  echo "ğŸ”— Learn more: https://www.conventionalcommits.org/"
  exit 1
fi

echo "âœ… Commit message format is valid!"